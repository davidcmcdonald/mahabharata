<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reading Aid for The Mahabharata retold by Kṛṣṇa Dharma</title>
  <link rel="stylesheet" href="./assets/style.css" />

  <!-- D3 for the family tree -->
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>

  <!-- Data must load before app.js -->
  <script src="data/people.js"></script>

  <!-- Main app logic -->
  <script type="module" src="js/app.js"></script>
  <!-- Family tree logic (imports from app.js) -->
  <script type="module" src="js/tree.js"></script>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Reading Aid for The Mahabharata retold by Kṛṣṇa Dharma</h1>

      <!-- Toolbar -->
      <div class="toolbar">

        <!-- Chapter slider + label -->
        <label class="chapter">
          <span>Chapter:</span>
          <input id="chapRange" type="range" min="1" max="83" value="1" />
          <span id="chapLabel">1</span>
        </label>

        <!-- Core toggles -->
        <label class="chk"><input id="soFar" type="checkbox" checked /> First mentioned ≤ chapter</label>
        <label class="chk"><input id="hiLite" type="checkbox" checked /> Highlight in this chapter</label>
        <label class="chk"><input id="hideDead" type="checkbox" /> Hide deceased</label>
        <label class="chk"><input id="hideAfterLast" type="checkbox" /> Hide if not mentioned again</label>

        <!-- Filters -->
        <select id="role"><option value="">All Roles</option></select>
        <select id="house"><option value="">All Houses</option></select>
        <select id="gen"><option value="">All Generations</option></select>

        <!-- Sort -->
        <select id="sort">
          <option value="alpha">Alphabetical</option>
          <option value="relevant" selected>Relevant now</option>
        </select>

        <!-- Search -->
        <label class="searchbox">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <circle cx="11" cy="11" r="7"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
          <input id="q" type="search" placeholder="Search people, aka, notes…" />
        </label>

        <!-- View toggles -->
        <div class="view-switch">
          <button id="showDir" class="btn">Directory</button>
          <button id="showTree" class="btn">Family Tree</button>
        </div>
      </div>

      <!-- Optional legend colours (match your existing styles/colors) -->
      <div class="legend">
        <span class="swatch sw-kaurava">Kaurava</span>
        <span class="swatch sw-pandava">Pandava</span>
        <span class="swatch sw-kuru">Kuru</span>
        <span class="swatch sw-sage">Sage</span>
        <span class="swatch sw-deity">Deity</span>
      </div>
    </div>
  </header>

  <main class="wrap">

    <!-- Directory pane -->
    <section id="dirPane">
      <div id="count" class="countline"></div>
      <div id="activeFilters" class="active-filters"></div>
      <div id="grid" class="grid"></div>
    </section>

    <!-- Family tree pane (hidden by default; toggled via JS) -->
    <section id="treePane" style="display:none">
      <div class="tree-toolbar">
        <label>Root:
          <select id="rootSelect"></select>
        </label>
        <button id="fitTree" class="btn">Fit to view</button>
        <button id="showDir2" class="btn" onclick="document.getElementById('showDir').click()">Back to Directory</button>
      </div>
      <svg id="tree" width="100%" height="800"></svg>
    </section>

  </main>
</body>
</html>
