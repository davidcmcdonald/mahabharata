<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mahābhārata Reader v5</title>
  <link rel="stylesheet" href="assets/style.css" />
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="title">Mahābhārata Reader <span class="tag">v5</span></div>
      <div class="actions">
        <button id="btnEdit" class="btn">✏️ Edit</button>
        <button id="btnExport" class="btn">⬇️ Export data</button>
      </div>
    </header>

    <section class="card slider-wrap">
      <div class="slider-head">
        <div>
          <label for="chapterSlider">Chapter <span id="chapterLabel">1</span> / <span id="chapterTotal">88</span></label>
          <div id="chapterMeta" class="subtle"></div>
        </div>
        <input id="chapterSlider" class="slider" type="range" min="1" max="88" step="1" value="1" />
      </div>
      <div id="chapterEditor" class="editor" style="display:none;">
        <div class="row">
          <label>Title<input type="text" id="edChTitle"></label>
        </div>
        <div class="row">
          <label>Summary<textarea id="edChSummary"></textarea></label>
        </div>
        <div class="row">
          <label>Events (one per line)<textarea id="edChEvents"></textarea></label>
        </div>
        <div class="actions-r">
          <button id="btnChSave" class="btn">Save chapter</button>
          <button id="btnChCancel" class="btn">Cancel</button>
        </div>
      </div>
    </section>

    <div class="row">
      <section class="card">
        <h2>Chapter Summary</h2>
        <div id="summary" class="richtext"></div>
      </section>

      <section class="card">
        <h2>Key Events</h2>
        <ul id="events" class="events"></ul>
      </section>
    </div>

    <section class="card controls">
      <div class="tabs">
        <button id="tabPeople" class="tab active">Characters</button>
        <button id="tabPlaces" class="tab">Places</button>
      </div>

      <div class="control-row">
        <label class="control">
          <span>Search</span>
          <input id="search" type="search" placeholder="name, aka, description…" />
        </label>
        <div class="spacer"></div>
        <div class="sorts">
          <label class="radio"><input type="radio" name="sort" value="relevance" checked /> Relevance</label>
          <label class="radio"><input type="radio" name="sort" value="alpha" /> A–Z</label>
          <label class="radio"><input type="radio" name="sort" value="first" /> First appearance</label>
        </div>
      </div>
    </section>

    <section class="card">
      <h2 id="gridTitle">Characters</h2>
      <div id="grid" class="grid"></div>
    </section>
  </div>

  <div id="hoverPreview" class="preview" style="display:none;"></div>
<div id="errorOverlay" style="display:none; position:fixed; inset:0; background:rgba(10,12,16,.9); color:#ffccd2; z-index:999999; padding:24px; overflow:auto; font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;"><div style="max-width:900px; margin:0 auto;"><h2 style="margin-top:0">⚠️ Script error</h2><pre id="errorText" style="white-space:pre-wrap"></pre><button id="btnSafeMode" style="background:#2a364a;color:#fff;border:1px solid #4a6aa8;border-radius:8px;padding:8px 12px;cursor:pointer">Enable Safe Mode (disable hover linking)</button></div></div>

  <script src="data/chapters.js?v=5b"></script>
  <script src="data/people.js?v=5b"></script>
  <script src="data/places.js?v=5b"></script>
  <script src="js/app.js"></script>
</body>
</html>
